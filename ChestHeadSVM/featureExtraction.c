#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#include "fft02.h"
#define max(a,b) ((a) > (b) ? (a) : (b))

void autoCorrelatiion(double *signal, double *outSignal, int size){
    double avg = 0;
    for(int i = 0; i < size; i++){
        printf("%f\n", signal[i]);
        avg += signal[i];
    }
    avg /= size;
    double val;
    for(int k = 0; k < size; k++){
        val = 0;
        for(int i = 0; i < size - k; i++){
            val += (signal[i] - avg)*(signal[i+k] - avg);
        }
        outSignal[k] = val;
    }
}

double sum(double *arr, int start, int end){
    double val = 0;
    for(int i = start; i < end; i++){
        val += arr[i];
    }
    return val;
}

double average(double *signal, int start, int end){
    double avg;
    avg = 0;
    for(int i = start; i <= end; i++){
        avg += signal[i];
    }
    avg /= (end - start + 1);
    return avg;
}

double harmonicity(double *spectrum, int low, int high){
    double *vocalRange;
    vocalRange = (double *) malloc(sizeof(double)*(high - low + 1));
    autoCorrelatiion(spectrum + low,vocalRange, high - low + 1);
    double maxVal = 0;
    for(int i = 1; i <= high - low; i++){
        maxVal = max(maxVal, vocalRange[i]);
    }
    return maxVal;
}

void SPDRatio(double *SPD, int size, int maxFreq, double* outVals){
    int c1 = (size*100)/maxFreq;
    int c2 = (size*1000)/maxFreq;
    int c3 = (size*2000)/maxFreq;
    int c4 = (size*6000)/maxFreq;
    printf("%d %d %d %d\n\n", c1,c2,c3,c4);
    double s1 = sum(SPD, c1, c2);
    double s2 = sum(SPD, c2, c3);
    double s3 = sum(SPD, c3, c4);
    printf("%lf %lf %lf\n\n", s1, s2, s3);
    outVals[0] = s3/(s1+s2);
    outVals[1] = (s2+s3)/s1;
}

double kurtosis(double *spectrum, int low, int high){
    double numerator = 0;
    double denominator = 0;
    double avg = 0;
    for(int i = low; i <= high; i++){
        avg += spectrum[i];
    }
    avg /= (high - low + 1);
    for(int i = low; i <= high; i++){
        numerator += pow(spectrum[i] - avg, 4);
        denominator += pow(spectrum[i] - avg, 2);
    }
    return (high - low + 1)*numerator/pow(denominator,2);
}

void centroidSpread(double *PSD, int size, int low, int high, int maxFreq, double *outVals){
    double stepSize = (double) maxFreq / (double)size;
    double denominator = 0;
    double numerator = 0;
    for(int i = low; i <= high; i++){
        numerator += log2(stepSize*((double)i+0.5)/1000.0)*PSD[i];
        denominator += PSD[i];
    }
    double SC = numerator / denominator;
    printf("%lf %lf \n", numerator, denominator);
    numerator = 0;
    for(int i = low; i <= high; i++){
        numerator += pow(log2(stepSize*((double)i+0.5)/1000.0)-SC, 2)*PSD[i];
    }
    double SS = sqrt(numerator / denominator);
    outVals[0] = SC;
    outVals[1] = SS;
}

void preEmphasis(double* sample, int size ,int maxFreq, double mu){
    for(int i = 1; i < size; i++){
        sample[i] -= mu*sample[i-1];
    }
}

void hammingWindow(double* sample, int size){
    double const scalingCoefficient = 6.2831852/(size-1); // 2pi/N
    double const a0 = 0.53836;
    double const a1 = 0.46164;
    for(int i = 0; i < size; i++){
        sample[i] *= (a0 + a1*cos(scalingCoefficient*i));
    }
    
}

void SpectrogramPSD(double *signal, int maxFreq, int size,  double *spectrogram, double *PSD, int low, int high){
    double *sample;
    sample = (double *) malloc(sizeof(double)*size);
    memcpy(sample, signal, sizeof(double)*2048);
    double avg = 0;
    for(int i = 0; i < size; i++){
        avg += sample[i];
    }
    avg /= size;
    for(int i = 0; i < size; i++){
        sample[i] -= avg;
    }
    preEmphasis(sample, size, maxFreq, 0.97);
    hammingWindow(sample, size);
    do_fft(sample, spectrogram);
    double *autocorrelatedSpectrogram;
    autocorrelatedSpectrogram = (double *) malloc(sizeof(double)*size);
    autoCorrelatiion(spectrogram, autocorrelatedSpectrogram, size);
    do_fft(autocorrelatedSpectrogram, PSD);
    free(autocorrelatedSpectrogram);
    double sum = 0;
    for(int i = 0; i < size; i++){
        spectrogram[i] = log10(spectrogram[i]);
    }
    for(int i = low; i <= high; i++){
        sum += spectrogram[i];
    }
    for(int i = 0; i < size; i++){
        spectrogram[i] /= sum;
    }
}

void extract(double *signal, int size, int lowFreq, int highFreq, int maxFreq, double *outVals){
    double *spectrogram;
    double *PSD;
    int low = (lowFreq*size)/maxFreq;
    int high = (highFreq*size)/maxFreq;
    spectrogram = (double *) malloc(sizeof(double)*size);
    PSD = (double *) malloc(sizeof(double)*size);
    SpectrogramPSD(signal, maxFreq, size, spectrogram, PSD, low, high);
    outVals[0] = harmonicity(spectrogram, low, high);
    double *temp;
    temp = (double *) malloc(sizeof(double)*2);
    SPDRatio(PSD, size, maxFreq, temp);
    outVals[1] = temp[0];
    outVals[2] = temp[1];
    outVals[3] = kurtosis(spectrogram, low, high);
    centroidSpread(PSD, size, low, high, maxFreq, temp);
    outVals[4] = temp[0];
    outVals[5] = temp[1];
    free(temp);
    free(spectrogram);
    free(PSD);
}


int main(){
    init_new_fft02(2048);
    double sample[2048] = {0.098711215,0.09371851,0.09143965,0.09017387,0.08954539,0.08783921,0.0855641,0.08564748,0.08765404,0.08971749,0.08868486,0.08753264,0.08961218,0.09253663,0.09430552,0.09505055,0.09520362,0.09609138,0.09805987,0.09881546,0.097389385,0.09303963,0.08770192,0.08374707,0.078505285,0.07017369,0.060614754,0.051606394,0.0439193,0.036567528,0.028142136,0.017941898,0.0068944315,-0.003794957,-0.013308889,-0.023818344,-0.037813034,-0.052423015,-0.066411294,-0.077914156,-0.088094994,-0.09917883,-0.11024673,-0.11997371,-0.12676555,-0.13163905,-0.13554631,-0.1405861,-0.14469585,-0.14681564,-0.1478473,-0.14755765,-0.1469338,-0.14600953,-0.14520724,-0.14396623,-0.14182451,-0.13889164,-0.13697314,-0.13534048,-0.13366918,-0.13174054,-0.12945734,-0.12846746,-0.12824671,-0.12879585,-0.13056031,-0.13381302,-0.13724309,-0.14181909,-0.14677918,-0.15047239,-0.15383519,-0.15825433,-0.1640403,-0.16906448,-0.17179182,-0.17361777,-0.17663017,-0.17938548,-0.18227267,-0.18300799,-0.1805253,-0.17556126,-0.16875221,-0.1619678,-0.15203485,-0.13920271,-0.1270454,-0.11635694,-0.1029488,-0.086486824,-0.070380166,-0.056466434,-0.04383669,-0.029016253,-0.011869639,0.007273981,0.026994223,0.04583253,0.06108228,0.07651819,0.09682807,0.11583845,0.13133417,0.14458944,0.15784435,0.17170623,0.1826732,0.19256361,0.20046498,0.20463789,0.20782115,0.21158145,0.2134896,0.20919017,0.20348474,0.2005823,0.20028499,0.19732213,0.19037348,0.1845183,0.17772046,0.17199081,0.16705094,0.162671,0.15752237,0.15106317,0.14783004,0.14636295,0.14400353,0.13919966,0.13681197,0.13749845,0.13738914,0.13574463,0.1328399,0.13045646,0.13012525,0.13271648,0.13560295,0.136381,0.13456595,0.13327752,0.13590312,0.13855873,0.13781595,0.13673057,0.13449034,0.1312916,0.12789986,0.12355333,0.1193717,0.1126858,0.10482166,0.096431166,0.08766169,0.07673378,0.063889034,0.052340258,0.040667493,0.0297878,0.017471118,0.0044728164,-0.008621446,-0.022087479,-0.034023985,-0.04620005,-0.05874014,-0.07200276,-0.084637955,-0.09474249,-0.10339822,-0.11146171,-0.11766059,-0.121737815,-0.124867834,-0.12721165,-0.12944053,-0.13286977,-0.13629486,-0.13774234,-0.13742328,-0.1368079,-0.1379434,-0.1386613,-0.13681637,-0.13389409,-0.1312057,-0.12887946,-0.12765665,-0.12786001,-0.12735274,-0.12696196,-0.12816602,-0.1312505,-0.13401489,-0.1341543,-0.13462968,-0.13620311,-0.13837269,-0.14217617,-0.14726548,-0.15167302,-0.15388316,-0.15711324,-0.16414101,-0.17120925,-0.17438649,-0.17597362,-0.17799178,-0.17765278,-0.17506361,-0.17228098,-0.16827065,-0.16254228,-0.15482794,-0.14583172,-0.13473956,-0.11907517,-0.103640616,-0.09043287,-0.07484601,-0.05617782,-0.037396558,-0.019573515,-0.0006434125,0.018261878,0.035219546,0.051491816,0.07064495,0.09105603,0.109212235,0.12727688,0.14378895,0.1556055,0.16321547,0.17224923,0.18418738,0.19260165,0.19541931,0.19617514,0.19838856,0.2007777,0.20255898,0.20430656,0.20419845,0.20105694,0.19643247,0.19205008,0.18578301,0.17800553,0.17218494,0.16736147,0.16150413,0.15405001,0.14704019,0.142189,0.13767011,0.13508223,0.13340475,0.1298029,0.12597424,0.123204,0.12319343,0.124209665,0.123141155,0.122165635,0.121873684,0.121148124,0.121512234,0.12116665,0.12018409,0.12110608,0.123395935,0.12570998,0.1258765,0.124744825,0.12331851,0.12162194,0.11965112,0.11718184,0.11246229,0.103730425,0.09430932,0.08678909,0.08005007,0.07112774,0.060618334,0.050439525,0.039769188,0.027413664,0.014101908,0.0008782898,-0.013651425,-0.02782898,-0.04072063,-0.053749505,-0.06747631,-0.08015132,-0.08996199,-0.09830634,-0.106371924,-0.11470653,-0.122895285,-0.13187087,-0.13957728,-0.14322823,-0.14560643,-0.14834651,-0.15009223,-0.14938,-0.14644799,-0.14292008,-0.13988478,-0.13686883,-0.13431719,-0.1315005,-0.1288087,-0.12838419,-0.12921797,-0.12970032,-0.1296149,-0.1310208,-0.13335806,-0.13611911,-0.14021097,-0.14535375,-0.14975387,-0.15308607,-0.15913385,-0.16595322,-0.17064674,-0.17322142,-0.17618333,-0.18046045,-0.18267713,-0.18442273,-0.18729149,-0.18830137,-0.18674798,-0.18616168,-0.1844743,-0.17965905,-0.1733561,-0.16598068,-0.1572573,-0.1448588,-0.13208781,-0.12072997,-0.107628584,-0.091083474,-0.0723626,-0.05424016,-0.035101205,-0.014431531,0.0058282083,0.025992999,0.04812824,0.07126595,0.091151364,0.10754689,0.12392004,0.13958116,0.15097636,0.15935671,0.16810726,0.17658967,0.18259555,0.18545644,0.18657956,0.18736978,0.18766935,0.18924437,0.18872826,0.18235251,0.17511702,0.17126139,0.16978462,0.16536197,0.15795776,0.15052047,0.1432368,0.13777775,0.13346568,0.12853724,0.12176065,0.11514766,0.11128329,0.10971877,0.10748408,0.10299695,0.100358866,0.099305734,0.09867597,0.09752469,0.09550422,0.09513069,0.09566022,0.097964115,0.09938355,0.098907925,0.09888339,0.09976604,0.10195523,0.1024024,0.100465424,0.09714773,0.093897305,0.09035246,0.086283684,0.081874825,0.074690714,0.065437675,0.056381922,0.048934072,0.040514,0.028808665,0.016077377,0.0041952063,-0.0074404166,-0.018785743,-0.029834302,-0.041314334,-0.05326295,-0.064865135,-0.07515374,-0.08562931,-0.09629965,-0.10625,-0.114322126,-0.121173546,-0.1275254,-0.1322217,-0.13627395,-0.14021339,-0.1438571,-0.14648914,-0.14847723,-0.15055355,-0.15287146,-0.15402421,-0.15432194,-0.15508193,-0.15512122,-0.15396315,-0.15228586,-0.1508859,-0.14959924,-0.14896281,-0.14832594,-0.1485321,-0.14876953,-0.14850652,-0.14939018,-0.15140153,-0.1547709,-0.15715982,-0.15879858,-0.16112977,-0.16546552,-0.17173418,-0.17832488,-0.18330942,-0.18729015,-0.19242878,-0.19727843,-0.20158692,-0.20414391,-0.20463492,-0.2035346,-0.20136532,-0.19659126,-0.18948448,-0.18145461,-0.1722612,-0.16351369,-0.15200886,-0.13752638,-0.12231761,-0.107041895,-0.090940274,-0.073251925,-0.053658117,-0.03153052,-0.010063834,0.009849986,0.02891846,0.048222076,0.068169706,0.085546866,0.10023135,0.1154107,0.12993005,0.14190085,0.15122645,0.16007063,0.16956994,0.17843224,0.18543777,0.18966576,0.19224735,0.19226699,0.19386771,0.19524604,0.19112113,0.18442594,0.17726323,0.17136191,0.16489193,0.15723194,0.14842232,0.14000091,0.13240938,0.12716982,0.12558468,0.12245261,0.11820457,0.11527028,0.11453116,0.11437512,0.11240315,0.10975366,0.10914545,0.10910984,0.108953305,0.11062184,0.11152668,0.11169363,0.11332385,0.11657972,0.118554145,0.11810011,0.116926976,0.11752168,0.11883428,0.11779117,0.11559656,0.11131966,0.10583364,0.10146559,0.09754999,0.09071796,0.080406524,0.07033613,0.062007118,0.054528955,0.04411977,0.03162704,0.020238096,0.0088021,-0.0021539205,-0.012848662,-0.025608422,-0.0399569,-0.05359912,-0.06493064,-0.075262606,-0.08671466,-0.098414764,-0.10841215,-0.11628033,-0.12222997,-0.12673718,-0.13118519,-0.13537121,-0.13797718,-0.13764161,-0.13551424,-0.13480605,-0.13497376,-0.13375506,-0.13171121,-0.13054906,-0.13033783,-0.13125764,-0.13333745,-0.13548987,-0.1367152,-0.13791496,-0.14105205,-0.14543694,-0.1487448,-0.1506399,-0.15432064,-0.1610818,-0.16734967,-0.17103128,-0.1735678,-0.17744759,-0.18363649,-0.19065267,-0.19582418,-0.19794023,-0.19941786,-0.20212835,-0.20633821,-0.20983906,-0.20911883,-0.20483178,-0.19872831,-0.19123131,-0.18207294,-0.17215355,-0.16243862,-0.15160638,-0.13911699,-0.12571964,-0.11202375,-0.09924623,-0.08632717,-0.07154635,-0.054060966,-0.03267844,-0.01043431,0.010399967,0.029453155,0.04830801,0.06844752,0.088287175,0.10811626,0.12736817,0.14387554,0.15561822,0.16564858,0.17695417,0.1890928,0.20009899,0.20724168,0.21139346,0.21300998,0.21363147,0.21428081,0.21286377,0.20771399,0.20119114,0.19586658,0.19141331,0.18681806,0.18146873,0.1761707,0.17076981,0.16644973,0.16261862,0.15785412,0.15267414,0.14781715,0.14440618,0.14258395,0.14050773,0.13725483,0.135696,0.13458021,0.13205613,0.12950568,0.1273069,0.12588069,0.12477942,0.12353968,0.12229079,0.11982312,0.116843365,0.11684651,0.118797235,0.11877622,0.11598796,0.112129316,0.108388565,0.10559341,0.10318273,0.0995015,0.09326155,0.085231744,0.078323156,0.0718966,0.06332137,0.052874055,0.042426657,0.031085417,0.018939342,0.006108296,-0.006828217,-0.018820435,-0.030743761,-0.04093772,-0.05079865,-0.06246121,-0.0746106,-0.08482349,-0.093786426,-0.10291695,-0.112257555,-0.12064187,-0.12668625,-0.13247618,-0.13707376,-0.1406445,-0.14339703,-0.14416881,-0.14306073,-0.1423902,-0.14445938,-0.1469008,-0.14741868,-0.1448823,-0.14186452,-0.14005333,-0.13938856,-0.13891768,-0.13725206,-0.13479061,-0.13382119,-0.13713996,-0.14262535,-0.14688997,-0.14919816,-0.1522852,-0.15627508,-0.1601028,-0.16358083,-0.16658565,-0.17008997,-0.17416833,-0.17959562,-0.18494539,-0.18902834,-0.19254334,-0.19597758,-0.19696707,-0.19336654,-0.18620968,-0.17731205,-0.16851059,-0.16052754,-0.15235712,-0.14099443,-0.1262635,-0.11223753,-0.10220039,-0.091259755,-0.07465366,-0.054104805,-0.03233506,-0.012581985,0.004704014,0.020461528,0.036892883,0.05437643,0.07009282,0.08383903,0.098176554,0.114993654,0.13108811,0.14354302,0.15542975,0.16853875,0.18113749,0.19129325,0.197049,0.19735542,0.19515856,0.1950864,0.1980444,0.20016257,0.19617979,0.18962835,0.18492772,0.18127653,0.17683665,0.17052197,0.16257076,0.15259099,0.14519578,0.14072141,0.13792339,0.13436465,0.12990516,0.1299675,0.13110931,0.13051333,0.12746178,0.12452536,0.12274755,0.12193129,0.123368904,0.12369102,0.12264045,0.1227373,0.1267024,0.13124694,0.13264115,0.13183676,0.13155988,0.132306,0.13124816,0.12843074,0.124336556,0.11934912,0.11450392,0.111355625,0.10702362,0.09814734,0.08683966,0.07638945,0.067147985,0.0569329,0.045453064,0.033437084,0.022210805,0.0123597905,0.0027866652,-0.00695885,-0.017128378,-0.028435491,-0.039527174,-0.051304147,-0.064677596,-0.077914044,-0.09013355,-0.10000773,-0.10869111,-0.11649851,-0.12408996,-0.13121288,-0.13694058,-0.14121918,-0.14312379,-0.14508525,-0.14787184,-0.151511,-0.15404415,-0.15331626,-0.15079737,-0.14729382,-0.14320262,-0.13933809,-0.1372059,-0.13625112,-0.13495345,-0.1327103,-0.1317516,-0.1338432,-0.13766702,-0.14181189,-0.1451067,-0.14763469,-0.15000844,-0.15372948,-0.15861532,-0.16318958,-0.1661105,-0.16776487,-0.17089386,-0.17576511,-0.179934,-0.1818019,-0.18276626,-0.18347886,-0.18357466,-0.18220614,-0.17902209,-0.17320684,-0.16502455,-0.15740936,-0.14878713,-0.13658284,-0.121659115,-0.108643375,-0.09681095,-0.08112436,-0.06279075,-0.042875014,-0.023002317,-0.005302771,0.0112749245,0.029933471,0.05322112,0.077092685,0.095114544,0.10877706,0.121789105,0.13628617,0.15251349,0.16616724,0.176838,0.18510164,0.19146377,0.19722925,0.20265241,0.20627463,0.20701505,0.20758708,0.20604454,0.20157321,0.19602041,0.19020946,0.1864307,0.18251753,0.17487578,0.16646092,0.15802562,0.14849837,0.14219812,0.13798691,0.13389009,0.12802805,0.1203644,0.11591672,0.11400881,0.112167604,0.11048784,0.10967792,0.10827434,0.108002685,0.10882026,0.10895174,0.11012717,0.11121219,0.113856554,0.11742648,0.11961006,0.12181286,0.12385545,0.12487585,0.12543593,0.12567043,0.12435352,0.12102261,0.11524624,0.10858849,0.10227367,0.09537342,0.08685222,0.07741429,0.06759042,0.055873115,0.04295573,0.029806616,0.017290398,0.0044407053,-0.009852038,-0.023651164,-0.036790594,-0.050586093,-0.06296386,-0.072854824,-0.08215802,-0.09083382,-0.100417055,-0.10925753,-0.11682298,-0.12435315,-0.1292178,-0.13279115,-0.13649623,-0.13971947,-0.14095359,-0.14147696,-0.14241394,-0.14181148,-0.13897108,-0.13560703,-0.13359049,-0.13040215,-0.12613524,-0.122383125,-0.11986295,-0.11786548,-0.11612067,-0.116453566,-0.11809323,-0.120553955,-0.124836035,-0.13085622,-0.1357464,-0.13925089,-0.14260018,-0.14784802,-0.15438752,-0.15934613,-0.16329268,-0.16578357,-0.16822748,-0.17247815,-0.17869304,-0.18305795,-0.18317538,-0.18216117,-0.1818233,-0.17978558,-0.17241555,-0.1618276,-0.15213005,-0.14429072,-0.13527328,-0.1226371,-0.10555423,-0.08579526,-0.06890622,-0.055605065,-0.040800877,-0.020392064,0.004298931,0.025738874,0.04140652,0.057231013,0.07496202,0.094972566,0.114259675,0.1300574,0.14320771,0.15633237,0.17226546,0.18454602,0.191132,0.19557858,0.20248431,0.21148035,0.21579255,0.21494724,0.21165803,0.20909207,0.20808835,0.20804618,0.20513208,0.19617192,0.18628448,0.17910258,0.17321596,0.16628928,0.15679984,0.14837988,0.14321904,0.14082573,0.13981155,0.13779704,0.13548298,0.13289098,0.13397987,0.13640495,0.13550593,0.13377336,0.1335542,0.13567299,0.13758746,0.13922334,0.13992165,0.14096135,0.14167704,0.14300267,0.14530046,0.14440031,0.1423896,0.14040896,0.13917583,0.1360619,0.12992351,0.12272013,0.116074204,0.1100808,0.10361334,0.09618225,0.08563208,0.07352963,0.061381917,0.050015677,0.03696636,0.02261791,0.008623161,-0.0061220275,-0.02096207,-0.036362305,-0.050169673,-0.062214382,-0.07365373,-0.08465022,-0.09492087,-0.10477162,-0.11335216,-0.11945075,-0.12370222,-0.12751698,-0.13310055,-0.13880372,-0.14242287,-0.14287561,-0.14138198,-0.14040521,-0.14018515,-0.13921028,-0.13750868,-0.13508028,-0.13194267,-0.13030732,-0.13037555,-0.13071434,-0.12983452,-0.13072103,-0.13447748,-0.13789092,-0.13936517,-0.14062051,-0.14432228,-0.14937405,-0.15469435,-0.1598165,-0.16369466,-0.16667546,-0.17278059,-0.183324,-0.19222513,-0.19455105,-0.19585213,-0.20130739,-0.20843239,-0.2132813,-0.21351056,-0.21039422,-0.20390472,-0.197835,-0.19286934,-0.18389212,-0.16895609,-0.15207237,-0.13910009,-0.12651949,-0.11033762,-0.091259845,-0.07279974,-0.05506086,-0.0371556,-0.02033312,-0.0015967677,0.020373976,0.04016581,0.053349502,0.06631941,0.08435613,0.10397157,0.11760223,0.12558681,0.13432787,0.14392868,0.15445554,0.16506828,0.17228173,0.17377722,0.17481925,0.18098113,0.1872532,0.18744348,0.18352948,0.18077096,0.17915754,0.17624132,0.17157112,0.16586606,0.15829243,0.15036644,0.14450298,0.13829587,0.1285425,0.11872321,0.11475475,0.11311193,0.1089813,0.1036781,0.10025123,0.098887645,0.098762386,0.09955655,0.09905555,0.0969199,0.094353646,0.094869465,0.09820214,0.09969517,0.09863704,0.09764285,0.098142706,0.098991394,0.10044823,0.10021695,0.09852964,0.096590236,0.09450878,0.09326336,0.08914615,0.0839718,0.079325646,0.07454537,0.068569444,0.059682064,0.04988144,0.038756855,0.027422767,0.016113294,0.004479341,-0.008179686,-0.021981634,-0.034829516,-0.04670966,-0.058037225,-0.07045119,-0.08296475,-0.09457969,-0.10520266,-0.11506314,-0.124150135,-0.13186027,-0.13882019,-0.1443907,-0.14971593,-0.15438516,-0.15768385,-0.16000728,-0.16125628,-0.16174659,-0.16163483,-0.16128446,-0.15973057,-0.1577747,-0.15582487,-0.15400921,-0.15329681,-0.15279861,-0.152329,-0.15176094,-0.15129602,-0.15251149,-0.15462138,-0.15592651,-0.15661849,-0.15649043,-0.15674825,-0.15806852,-0.15987146,-0.16295841,-0.16686206,-0.17105286,-0.17597108,-0.17947401,-0.18078786,-0.18478909,-0.19015335,-0.19244957,-0.19253127,-0.18932913,-0.18304476,-0.17695874,-0.17358817,-0.16999929,-0.16027258,-0.144697,-0.1307956,-0.121750765,-0.1111504,-0.098144315,-0.08243469,-0.0625504,-0.042580638,-0.022977784,-0.004758112,0.014243091,0.036345232,0.057171628,0.075503714,0.09394372,0.11400701,0.13060261,0.14349559,0.15569584,0.16690496,0.1788438,0.1885481,0.19714822,0.20260821,0.20285372,0.20507935,0.2094337,0.21160662,0.20772094,0.20173119,0.19724795,0.19330074,0.18806073,0.18101671,0.17420006,0.16341808,0.1547576,0.15062194,0.1448877,0.13690862,0.12809949,0.12386404,0.12139281,0.11845643,0.11499774,0.11213666,0.109969325,0.10772468,0.1097056,0.11019126,0.10977441,0.11222893,0.11581567,0.12011436,0.12197248,0.124461934,0.1281119,0.1323509,0.13624753,0.13787378,0.13829839,0.13551559,0.13332663,0.13159189,0.12765875,0.12133786,0.111839764,0.10279874,0.09373405,0.08385651,0.0720484,0.059222553,0.0462227,0.033278663,0.021507058,0.008037367,-0.0050513227,-0.017921979,-0.029650068,-0.03984247,-0.05136971,-0.06286345,-0.07396923,-0.083749205,-0.09239281,-0.09937669,-0.105340265,-0.11128888,-0.11683206,-0.12121016,-0.123144805,-0.124671854,-0.12603214,-0.12586185,-0.124304585,-0.12323734,-0.122976355,-0.12194951,-0.12014214,-0.11763295,-0.1152163,-0.11355975,-0.1124144,-0.11195266,-0.11159641,-0.1111929,-0.111715175,-0.11331156,-0.11646414,-0.12151642,-0.128248,-0.13534383,-0.14182936,-0.14850338,-0.15627928,-0.1646696,-0.17132255,-0.17709012,-0.18275335,-0.18610008,-0.18825027,-0.1902982,-0.19141695,-0.1903142,-0.18533406,-0.17928652,-0.17337145,-0.16563413,-0.15685098,-0.14734371,-0.13493541,-0.11832923,-0.101109855,-0.0846609,-0.06745949,-0.048409812,-0.02724724,-0.0054203975,0.016828917,0.036300648,0.05197451,0.0684497,0.08748655,0.10638736,0.12211216,0.1354485,0.14730906,0.15806639,0.17009503,0.18230194,0.19403484,0.20234673,0.20512287,0.20807998,0.21020643,0.21138856,0.21190083,0.21004742,0.20633891,0.19959775,0.19273973,0.18575767,0.17995128,0.17399094,0.16676915,0.15951154,0.15025608,0.14392342,0.14035477,0.13739051,0.13313618,0.12722042,0.12222253,0.11757923,0.114763364,0.11407803,0.114880614,0.11408438,0.11362074,0.116028555,0.11912846,0.1228458,0.1262586,0.12872477,0.1303682,0.13262953,0.1348376,0.13641764,0.13570406,0.13378105,0.13213307,0.12829061,0.123403475,0.117805175,0.11175506,0.10396535,0.09490202,0.085350715,0.0755455,0.06467453,0.052786093,0.042159762,0.029854676,0.016486865,0.0025823934,-0.010765193,-0.023948662,-0.03781258,-0.05173925,-0.06599585,-0.07837879,-0.090396434,-0.10107723,-0.11161195,-0.12211406,-0.13045253,-0.13727109,-0.14205629,-0.14548703,-0.14794825,-0.14946035,-0.14960279,-0.14887342,-0.14702827,-0.14551856,-0.14494278,-0.14408007,-0.14316921,-0.14227071,-0.1410577,-0.14037602,-0.1400228,-0.13795169,-0.13543524,-0.13380702,-0.1346464,-0.13599086,-0.13662583,-0.1387038,-0.14288923,-0.14776455,-0.15193103,-0.15747738,-0.163221,-0.16789402,-0.17227209,-0.17808309,-0.18279634,-0.18461454,-0.1874078,-0.19221225,-0.19569571,-0.19475795,-0.19158442,-0.18719985,-0.18216479,-0.17789264,-0.17377359,-0.16512772,-0.1514415,-0.13673748,-0.12382131,-0.11151562,-0.09479786,-0.075331114,-0.05390115,-0.032465562,-0.011696566,0.0075969384,0.024397302,0.04324653,0.063350774,0.08147141,0.097306825,0.114300475,0.1300491,0.14096612,0.14894825,0.15803926,0.16802323,0.17442232,0.17670213,0.17627683,0.17471655,0.17110698,0.16950014,0.16841008,0.16385089,0.15886103,0.1542558,0.15134254,0.1472596,0.14281814,0.13994847,0.13507706,0.12828629,0.12165014,0.116412036,0.11154174,0.107193075,0.10442899,0.102278054,0.100611605,0.0988097,0.09901886,0.10100992,0.10152576,0.10292596,0.104431786,0.10565156,0.106582105,0.10636597,0.106515,0.107124835,0.10830773,0.10944673,0.11082237,0.1104994,0.10963232,0.10820012,0.10510285,0.10181069,0.09627612,0.09097936,0.084729075,0.07611301,0.06695484,0.057155877,0.046951924,0.035428267,0.024170917,0.012115951,-0.0016694749,-0.015899941,-0.029130599,-0.040602576,-0.052586205,-0.06528904,-0.07768314,-0.089475594,-0.100353606,-0.10973206,-0.118359886,-0.12729885,-0.1359996,-0.14301753,-0.14838254,-0.15351279,-0.15801296,-0.16034952,-0.16072094,-0.16085166,-0.16029522,-0.15995571,-0.1602177,-0.16003315,-0.15917677,-0.15735947,-0.15629737,-0.15664823,-0.15730979,-0.15666041,-0.15707238,-0.15934,-0.16152531,-0.16339281,-0.16573474,-0.17021275,-0.17437878,-0.17855489,-0.18269691,-0.18571243,-0.1884938,-0.19205502,-0.19755237,-0.20219971,-0.20479009,-0.20628631,-0.20792647,-0.21022551,-0.2120741,-0.2116831,-0.20792209,-0.19937971,-0.19006601,-0.18424553,-0.17826135,-0.16930829,-0.15617497,-0.14270996,-0.13065715,-0.119731426,-0.10830299,-0.09248126,-0.07243333,-0.050858032,-0.033052363,-0.014983698,0.0058501973,0.027451696,0.04910655,0.068325974,0.0867036,0.10420897,0.121446624,0.13744469,0.14998236,0.1595147,0.16926262,0.18064763,0.18808751,0.19033429,0.19004299,0.19012403,0.19064902,0.18950425,0.18810047,0.18370248,0.17709109,0.17242052,0.16905089,0.16564311,0.15913153,0.15229659,0.14720306,0.14211637,0.1376547,0.13438962,0.13257731,0.12932527,0.12653995,0.12618256,0.12505338,0.122890346,0.12210317,0.124409884,0.12705906,0.12743787,0.12840502,0.13138242,0.13447055,0.13770768,0.14163,0.14485492,0.14504753,0.14460927,0.14579406,0.14614822,0.14318769,0.13829613,0.13344528,0.12726177,0.12075045,0.11395855,0.106950805,0.09775547,0.08666431,0.07685818,0.06602858,0.053716768,0.04111508,0.029701347,0.017284377,0.0036180695,-0.009683946,-0.022537412,-0.03434384,-0.04706299,-0.05852487,-0.06906038,-0.080161385,-0.09005396,-0.09855947,-0.10594573,-0.1130719,-0.1197702,-0.12547712,-0.13003023,-0.1328251,-0.13402188,-0.13461454,-0.13485952,-0.13496602,-0.13456404,-0.13398045,-0.13285787,-0.13127148,-0.130474,-0.13016842,-0.13071948,-0.13101299,-0.13087082,-0.13058329,-0.13076551,-0.13327277,-0.13708967,-0.14074379,-0.14405751,-0.14773034,-0.1522664,-0.15820384,-0.16550389,-0.17356057,-0.1800285,-0.18333325,-0.1863426,-0.1905154,-0.19458672,-0.19814704,-0.20046009,-0.19946146,-0.19533092,-0.18887347,-0.18262823,-0.17709975,-0.16905801,-0.15855063,-0.14496732,-0.12923296,-0.11221978,-0.09631774,-0.08164195,-0.06400362,-0.043929987,-0.021439794,-0.00021439354,0.019064346,0.036206815,0.050564766,0.067767404,0.08776351,0.10807675,0.124703586,0.13826777,0.15072048,0.16160186,0.17272764,0.18414186,0.19502154,0.20118397,0.20251192,0.20235698,0.20337312,0.20442803,0.20336077,0.20144477,0.19668728,0.1904932,0.18586367,0.18295749,0.17964448,0.17384703,0.16690083,0.159587,0.15335387,0.14820033,0.14399102,0.14169009,0.1381244,0.1341472,0.13203914,0.13100801,0.1310348,0.1309184,0.13180159,0.13161509,0.13111308,0.13173229,0.13241366,0.13423687,0.13380563,0.13340881,0.13380834,0.1346245,0.13597713,0.13650031,0.13661227,0.13415994,0.13072157,0.12640804,0.122479,0.11729777,0.10984872,0.10221625,0.09379139,0.08640531,0.07828855,0.069756396,0.059816822,0.047856364,0.03643215,0.024946792,0.013267488,0.00060599,-0.012254454,-0.024516413,-0.03644583,-0.048175596,-0.05980922,-0.069957115,-0.07950134,-0.08851094,-0.09495595,-0.100989014,-0.10658761,-0.11140945,-0.11506499,-0.1159844,-0.11656262,-0.11744721,-0.11850042,-0.11875221,-0.11934355,-0.1205271,-0.121391766,-0.12205238,-0.121563025,-0.12159575,-0.12225508,-0.123694114,-0.12497121,-0.12501466,-0.12334381,-0.122770354,-0.12542418,-0.12832029,-0.13023427,-0.1299492,-0.13013127,-0.13235985,-0.13767475,-0.14571166,-0.15208425,-0.15546302,-0.15790468,-0.16318375,-0.16935867,-0.17355148,-0.17599775,-0.17691639,-0.17596972,-0.17285167,-0.16795495,-0.16253802,-0.15759064,-0.15242636,-0.14504547,-0.13281448,-0.11761512,-0.10271791,-0.09142268,-0.08077471,-0.06376438,-0.0405524,-0.015525196,0.0032841023,0.015918901,0.029983565,0.04995708,0.07465042,0.09664402,0.1128271,0.12561888,0.13982694,0.15710004,0.17272562,0.18274674,0.18920228,0.19794476,0.20808992,0.2156575,0.21836151,0.21823494,0.2208889,0.22490454,0.2266606,0.2225622,0.21393599,0.20659909,0.202918,0.19990742,0.19136609,0.17944898,0.16950376,0.16501193,0.1634978,0.15919313,0.15116867,0.14296469,0.13995396,0.13954282,0.13752162,0.1314734,0.12419501,0.121917985,0.124807626,0.12929136,0.13068072,0.12901038,0.12793757,0.13059628,0.13517736,0.13884495,0.14023869,0.14019741,0.14163177,0.14342122,0.14404249,0.14172365,0.13787398,0.13462618,0.13068883,0.12413627,0.11434316,0.10314667,0.09318894,0.086039916,0.07753299,0.064926036,0.050196983,0.03660642,0.02540974,0.014327622,0.0016640187,-0.013704202,-0.029609168,-0.043456595,-0.0542125,-0.064079605,-0.07598903,-0.08663899,-0.094459005,-0.10085072,-0.107168704,-0.11491506,-0.12270625,-0.12834385,-0.1306506,-0.13077404,-0.13136205,-0.13318053,-0.13472356,-0.13420297,-0.1324052,-0.13088323,-0.13043872,-0.13118516,-0.13220306,-0.1333246,-0.13408938,-0.13447422,-0.13496052,-0.13500638,-0.13538782,-0.13716745,-0.14050902,-0.14516717,-0.14983793,-0.15311232,-0.15624748,-0.16167252,-0.16886443,-0.17570849,-0.18003762,-0.18208374,-0.18376817,-0.18717934,-0.19267559,-0.19697712,-0.19827987,-0.19609454,-0.19271955,-0.18944736,-0.18401092,-0.17656407,-0.16753453,-0.15702388,-0.14514168,-0.13179612,-0.116572194,-0.10127948,-0.08686522,-0.071586326,-0.053533345,-0.030831434,-0.007835147,0.011557857,0.028875155,0.047165412,0.06753147,0.087868266,0.10614784,0.120024845,0.13086894,0.14167413};
    double *features;
    features = (double *) malloc(sizeof(double)*6);
    double *signal;
    //signal = (double *) malloc(sizeof(double)*2048);
    memcpy(signal, sample, 2048*sizeof(double));
    extract(signal, 2048, 100, 10000, 44100, features);
    for(int i = 0; i < 6; i++){
        printf("%f ",features[i]);
    }
    return 0;
}